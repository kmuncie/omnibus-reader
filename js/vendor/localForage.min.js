/*!
  localForage -- Offline Storage, Improved
  http://mozilla.github.io/localForage
  (c) 2013-2014 Mozilla, Apache License 2.0
*/
!function(){var define,requireModule,require,requirejs;!function(){var registry={},seen={};define=function(name,deps,callback){registry[name]={deps:deps,callback:callback}},requirejs=require=requireModule=function(name){function resolve(child){if("."!==child.charAt(0))return child;for(var parts=child.split("/"),parentBase=name.split("/").slice(0,-1),i=0,l=parts.length;l>i;i++){var part=parts[i];if(".."===part)parentBase.pop();else{if("."===part)continue;parentBase.push(part)}}return parentBase.join("/")}if(requirejs._eak_seen=registry,seen[name])return seen[name];if(seen[name]={},!registry[name])throw new Error("Could not find module "+name);for(var exports,mod=registry[name],deps=mod.deps,callback=mod.callback,reified=[],i=0,l=deps.length;l>i;i++)reified.push("exports"===deps[i]?exports={}:requireModule(resolve(deps[i])));var value=callback.apply(this,reified);return seen[name]=exports||value}}(),define("promise/all",["./utils","exports"],function(__dependency1__,__exports__){"use strict";function all(promises){var Promise=this;if(!isArray(promises))throw new TypeError("You must pass an array to all.");return new Promise(function(resolve,reject){function resolver(index){return function(value){resolveAll(index,value)}}function resolveAll(index,value){results[index]=value,0===--remaining&&resolve(results)}var promise,results=[],remaining=promises.length;0===remaining&&resolve([]);for(var i=0;i<promises.length;i++)promise=promises[i],promise&&isFunction(promise.then)?promise.then(resolver(i),reject):resolveAll(i,promise)})}var isArray=__dependency1__.isArray,isFunction=__dependency1__.isFunction;__exports__.all=all}),define("promise/asap",["exports"],function(__exports__){"use strict";function useNextTick(){return function(){process.nextTick(flush)}}function useMutationObserver(){var iterations=0,observer=new BrowserMutationObserver(flush),node=document.createTextNode("");return observer.observe(node,{characterData:!0}),function(){node.data=iterations=++iterations%2}}function useSetTimeout(){return function(){local.setTimeout(flush,1)}}function flush(){for(var i=0;i<queue.length;i++){var tuple=queue[i],callback=tuple[0],arg=tuple[1];callback(arg)}queue=[]}function asap(callback,arg){var length=queue.push([callback,arg]);1===length&&scheduleFlush()}var scheduleFlush,browserGlobal="undefined"!=typeof window?window:{},BrowserMutationObserver=browserGlobal.MutationObserver||browserGlobal.WebKitMutationObserver,local="undefined"!=typeof global?global:this,queue=[];scheduleFlush="undefined"!=typeof process&&"[object process]"==={}.toString.call(process)?useNextTick():BrowserMutationObserver?useMutationObserver():useSetTimeout(),__exports__.asap=asap}),define("promise/cast",["exports"],function(__exports__){"use strict";function cast(object){if(object&&"object"==typeof object&&object.constructor===this)return object;var Promise=this;return new Promise(function(resolve){resolve(object)})}__exports__.cast=cast}),define("promise/config",["exports"],function(__exports__){"use strict";function configure(name,value){return 2!==arguments.length?config[name]:void(config[name]=value)}var config={instrument:!1};__exports__.config=config,__exports__.configure=configure}),define("promise/polyfill",["./promise","./utils","exports"],function(__dependency1__,__dependency2__,__exports__){"use strict";function polyfill(){var es6PromiseSupport="Promise"in window&&"cast"in window.Promise&&"resolve"in window.Promise&&"reject"in window.Promise&&"all"in window.Promise&&"race"in window.Promise&&function(){var resolve;return new window.Promise(function(r){resolve=r}),isFunction(resolve)}();es6PromiseSupport||(window.Promise=RSVPPromise)}var RSVPPromise=__dependency1__.Promise,isFunction=__dependency2__.isFunction;__exports__.polyfill=polyfill}),define("promise/promise",["./config","./utils","./cast","./all","./race","./resolve","./reject","./asap","exports"],function(__dependency1__,__dependency2__,__dependency3__,__dependency4__,__dependency5__,__dependency6__,__dependency7__,__dependency8__,__exports__){"use strict";function Promise(resolver){if(!isFunction(resolver))throw new TypeError("You must pass a resolver function as the first argument to the promise constructor");if(!(this instanceof Promise))throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");this._subscribers=[],invokeResolver(resolver,this)}function invokeResolver(resolver,promise){function resolvePromise(value){resolve(promise,value)}function rejectPromise(reason){reject(promise,reason)}try{resolver(resolvePromise,rejectPromise)}catch(e){rejectPromise(e)}}function invokeCallback(settled,promise,callback,detail){var value,error,succeeded,failed,hasCallback=isFunction(callback);if(hasCallback)try{value=callback(detail),succeeded=!0}catch(e){failed=!0,error=e}else value=detail,succeeded=!0;handleThenable(promise,value)||(hasCallback&&succeeded?resolve(promise,value):failed?reject(promise,error):settled===FULFILLED?resolve(promise,value):settled===REJECTED&&reject(promise,value))}function subscribe(parent,child,onFulfillment,onRejection){var subscribers=parent._subscribers,length=subscribers.length;subscribers[length]=child,subscribers[length+FULFILLED]=onFulfillment,subscribers[length+REJECTED]=onRejection}function publish(promise,settled){for(var child,callback,subscribers=promise._subscribers,detail=promise._detail,i=0;i<subscribers.length;i+=3)child=subscribers[i],callback=subscribers[i+settled],invokeCallback(settled,child,callback,detail);promise._subscribers=null}function handleThenable(promise,value){var resolved,then=null;try{if(promise===value)throw new TypeError("A promises callback cannot return that same promise.");if(objectOrFunction(value)&&(then=value.then,isFunction(then)))return then.call(value,function(val){return resolved?!0:(resolved=!0,void(value!==val?resolve(promise,val):fulfill(promise,val)))},function(val){return resolved?!0:(resolved=!0,void reject(promise,val))}),!0}catch(error){return resolved?!0:(reject(promise,error),!0)}return!1}function resolve(promise,value){promise===value?fulfill(promise,value):handleThenable(promise,value)||fulfill(promise,value)}function fulfill(promise,value){promise._state===PENDING&&(promise._state=SEALED,promise._detail=value,config.async(publishFulfillment,promise))}function reject(promise,reason){promise._state===PENDING&&(promise._state=SEALED,promise._detail=reason,config.async(publishRejection,promise))}function publishFulfillment(promise){publish(promise,promise._state=FULFILLED)}function publishRejection(promise){publish(promise,promise._state=REJECTED)}var config=__dependency1__.config,objectOrFunction=(__dependency1__.configure,__dependency2__.objectOrFunction),isFunction=__dependency2__.isFunction,cast=(__dependency2__.now,__dependency3__.cast),all=__dependency4__.all,race=__dependency5__.race,staticResolve=__dependency6__.resolve,staticReject=__dependency7__.reject,asap=__dependency8__.asap;config.async=asap;var PENDING=void 0,SEALED=0,FULFILLED=1,REJECTED=2;Promise.prototype={constructor:Promise,_state:void 0,_detail:void 0,_subscribers:void 0,then:function(onFulfillment,onRejection){var promise=this,thenPromise=new this.constructor(function(){});if(this._state){var callbacks=arguments;config.async(function(){invokeCallback(promise._state,thenPromise,callbacks[promise._state-1],promise._detail)})}else subscribe(this,thenPromise,onFulfillment,onRejection);return thenPromise},"catch":function(onRejection){return this.then(null,onRejection)}},Promise.all=all,Promise.cast=cast,Promise.race=race,Promise.resolve=staticResolve,Promise.reject=staticReject,__exports__.Promise=Promise}),define("promise/race",["./utils","exports"],function(__dependency1__,__exports__){"use strict";function race(promises){var Promise=this;if(!isArray(promises))throw new TypeError("You must pass an array to race.");return new Promise(function(resolve,reject){for(var promise,i=0;i<promises.length;i++)promise=promises[i],promise&&"function"==typeof promise.then?promise.then(resolve,reject):resolve(promise)})}var isArray=__dependency1__.isArray;__exports__.race=race}),define("promise/reject",["exports"],function(__exports__){"use strict";function reject(reason){var Promise=this;return new Promise(function(resolve,reject){reject(reason)})}__exports__.reject=reject}),define("promise/resolve",["exports"],function(__exports__){"use strict";function resolve(value){var Promise=this;return new Promise(function(resolve){resolve(value)})}__exports__.resolve=resolve}),define("promise/utils",["exports"],function(__exports__){"use strict";function objectOrFunction(x){return isFunction(x)||"object"==typeof x&&null!==x}function isFunction(x){return"function"==typeof x}function isArray(x){return"[object Array]"===Object.prototype.toString.call(x)}var now=Date.now||function(){return(new Date).getTime()};__exports__.objectOrFunction=objectOrFunction,__exports__.isFunction=isFunction,__exports__.isArray=isArray,__exports__.now=now}),requireModule("promise/polyfill").polyfill()}(),function(){"use strict";function withStore(type,f){if(db)f(db.transaction(STORENAME,type).objectStore(STORENAME));else{var openreq=indexedDB.open(DBNAME,DBVERSION);openreq.onerror=function(){console.error("asyncStorage: can't open database:",openreq.error.name)},openreq.onupgradeneeded=function(){openreq.result.createObjectStore(STORENAME)},openreq.onsuccess=function(){db=openreq.result,f(db.transaction(STORENAME,type).objectStore(STORENAME))}}}function getItem(key,callback){return new Promise(function(resolve){withStore("readonly",function(store){var req=store.get(key);req.onsuccess=function(){var value=req.result;void 0===value&&(value=null),callback&&callback(value),resolve(value)},req.onerror=function(){console.error("Error in asyncStorage.getItem(): ",req.error.name)}})})}function setItem(key,value,callback){return new Promise(function(resolve){withStore("readwrite",function(store){void 0===value&&(value=null);var req=store.put(value,key);req.onsuccess=function(){callback&&callback(value),resolve(value)},req.onerror=function(){console.error("Error in asyncStorage.setItem(): ",req.error.name)}})})}function removeItem(key,callback){return new Promise(function(resolve){withStore("readwrite",function(store){var req=store["delete"](key);req.onsuccess=function(){callback&&callback(),resolve()},req.onerror=function(){console.error("Error in asyncStorage.removeItem(): ",req.error.name)}})})}function clear(callback){return new Promise(function(resolve){withStore("readwrite",function(store){var req=store.clear();req.onsuccess=function(){callback&&callback(),resolve()},req.onerror=function(){console.error("Error in asyncStorage.clear(): ",req.error.name)}})})}function length(callback){return new Promise(function(resolve){withStore("readonly",function(store){var req=store.count();req.onsuccess=function(){callback&&callback(req.result),resolve(req.result)},req.onerror=function(){console.error("Error in asyncStorage.length(): ",req.error.name)}})})}function key(n,callback){return new Promise(function(resolve){return 0>n?(callback&&callback(null),void resolve(null)):void withStore("readonly",function(store){var advanced=!1,req=store.openCursor();req.onsuccess=function(){var cursor=req.result;return cursor?void(0===n?(callback&&callback(cursor.key),resolve(cursor.key)):advanced?(callback&&callback(cursor.key),resolve(cursor.key)):(advanced=!0,cursor.advance(n))):(callback&&callback(null),void resolve(null))},req.onerror=function(){console.error("Error in asyncStorage.key(): ",req.error.name)}})})}var DBNAME="asyncStorage",DBVERSION=1,STORENAME="keyvaluepairs",Promise=window.Promise,db=null,indexedDB=indexedDB||window.indexedDB||window.webkitIndexedDB||window.mozIndexedDB||window.OIndexedDB||window.msIndexedDB;if(indexedDB){var asyncStorage={driver:"asyncStorage",getItem:getItem,setItem:setItem,removeItem:removeItem,clear:clear,length:length,key:key};"function"==typeof define&&define.amd?define("asyncStorage",function(){return asyncStorage}):"undefined"!=typeof module&&module.exports?module.exports=asyncStorage:this.asyncStorage=asyncStorage}}.call(this),function(){"use strict";function clear(callback){return new Promise(function(resolve){localStorage.clear(),callback&&callback(),resolve()})}function getItem(key,callback){return new Promise(function(resolve,reject){try{var result=localStorage.getItem(key);result&&(result=JSON.parse(result)),callback&&callback(result),resolve(result)}catch(e){reject(e)}})}function key(n,callback){return new Promise(function(resolve){var result=localStorage.key(n);callback&&callback(result),resolve(result)})}function length(callback){return new Promise(function(resolve){var result=localStorage.length;callback&&callback(result),resolve(result)})}function removeItem(key,callback){return new Promise(function(resolve){localStorage.removeItem(key),callback&&callback(),resolve()})}function setItem(key,value,callback){return new Promise(function(resolve,reject){void 0===value&&(value=null);var originalValue=value;try{value=JSON.stringify(value)}catch(e){console.error("Couldn't convert value into a JSON string: ",value),reject(e)}localStorage.setItem(key,value),callback&&callback(originalValue),resolve(originalValue)})}var Promise=window.Promise;try{var localStorage=window.localStorage}catch(e){return}var localStorageWrapper={driver:"localStorageWrapper",getItem:getItem,setItem:setItem,removeItem:removeItem,clear:clear,length:length,key:key};"function"==typeof define&&define.amd?define("localStorageWrapper",function(){return localStorageWrapper}):"undefined"!=typeof module&&module.exports?module.exports=localStorageWrapper:this.localStorageWrapper=localStorageWrapper}.call(this),function(){"use strict";function getItem(key,callback){return new Promise(function(resolve,reject){db.transaction(function(t){t.executeSql("SELECT * FROM localforage WHERE key = ? LIMIT 1",[key],function(t,results){var result=results.rows.length?results.rows.item(0).value:null;if(result&&result.substr(0,SERIALIZED_MARKER_LENGTH)===SERIALIZED_MARKER)try{result=JSON.parse(result.slice(SERIALIZED_MARKER_LENGTH))}catch(e){reject(e)}callback&&callback(result),resolve(result)},null)})})}function setItem(key,value,callback){return new Promise(function(resolve){void 0===value&&(value=null);var valueToSave;valueToSave="boolean"==typeof value||"number"==typeof value||"object"==typeof value?SERIALIZED_MARKER+JSON.stringify(value):value,db.transaction(function(t){t.executeSql("INSERT OR REPLACE INTO localforage (key, value) VALUES (?, ?)",[key,valueToSave],function(){callback&&callback(value),resolve(value)},null)})})}function removeItem(key,callback){return new Promise(function(resolve){db.transaction(function(t){t.executeSql("DELETE FROM localforage WHERE key = ?",[key],function(){callback&&callback(),resolve()},null)})})}function clear(callback){return new Promise(function(resolve){db.transaction(function(t){t.executeSql("DELETE FROM localforage",[],function(){callback&&callback(),resolve()},null)})})}function length(callback){return new Promise(function(resolve){db.transaction(function(t){t.executeSql("SELECT COUNT(key) as c FROM localforage",[],function(t,results){var result=results.rows.item(0).c;callback&&callback(result),resolve(result)},null)})})}function key(n,callback){return new Promise(function(resolve){db.transaction(function(t){t.executeSql("SELECT key FROM localforage WHERE id = ? LIMIT 1",[n+1],function(t,results){var result=results.rows.length?results.rows.item(0).key:null;callback&&callback(result),resolve(result)},null)})})}var DB_NAME="localforage",DB_SIZE=4980736,DB_VERSION="1.0",SERIALIZED_MARKER="__lfsc__:",SERIALIZED_MARKER_LENGTH=SERIALIZED_MARKER.length,STORE_NAME="keyvaluepairs",Promise=window.Promise;if(window.openDatabase){var db=window.openDatabase(DB_NAME,DB_VERSION,STORE_NAME,DB_SIZE);db.transaction(function(t){t.executeSql("CREATE TABLE IF NOT EXISTS localforage (id INTEGER PRIMARY KEY, key unique, value)")});var webSQLStorage={driver:"webSQLStorage",getItem:getItem,setItem:setItem,removeItem:removeItem,clear:clear,length:length,key:key};"function"==typeof define&&define.amd?define("webSQLStorage",function(){return webSQLStorage}):"undefined"!=typeof module&&module.exports?module.exports=webSQLStorage:this.webSQLStorage=webSQLStorage}}.call(this),function(){"use strict";var Promise=window.Promise,MODULE_TYPE_DEFINE=1,MODULE_TYPE_EXPORT=2,MODULE_TYPE_WINDOW=3,moduleType=MODULE_TYPE_WINDOW;"function"==typeof define&&define.amd?moduleType=MODULE_TYPE_DEFINE:"undefined"!=typeof module&&module.exports&&(moduleType=MODULE_TYPE_EXPORT);var storageLibrary,indexedDB=indexedDB||window.indexedDB||window.webkitIndexedDB||window.mozIndexedDB||window.OIndexedDB||window.msIndexedDB,_this=this,localForage={INDEXEDDB:"asyncStorage",LOCALSTORAGE:"localStorageWrapper",WEBSQL:"webSQLStorage",setDriver:function(driverName,callback){return new Promise(function(resolve,reject){return!indexedDB&&driverName===localForage.INDEXEDDB||!window.openDatabase&&driverName===localForage.WEBSQL?(callback&&callback(localForage),void reject(localForage)):void(moduleType===MODULE_TYPE_DEFINE?require([driverName],function(lib){localForage._extend(lib),callback&&callback(localForage),resolve(localForage)}):moduleType===MODULE_TYPE_EXPORT?(localForage._extend(require("./"+driverName)),callback&&callback(localForage),resolve(localForage)):(localForage._extend(_this[driverName]),callback&&callback(localForage),resolve(localForage)))})},_extend:function(libraryMethodsAndProperties){for(var i in libraryMethodsAndProperties)libraryMethodsAndProperties.hasOwnProperty(i)&&(this[i]=libraryMethodsAndProperties[i])}};storageLibrary=indexedDB?localForage.INDEXEDDB:window.openDatabase?localForage.WEBSQL:localForage.LOCALSTORAGE,localForage.setDriver(storageLibrary),moduleType===MODULE_TYPE_DEFINE?define(function(){return localForage}):moduleType===MODULE_TYPE_EXPORT?module.exports=localForage:this.localforage=localForage}.call(this);